<html>
  <head>
    <script src="" type="text/javascript"></script>
    <script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app217.us.archive.org';v.server_ms=182;archive_analytics.send_pageview({});});</script>
    <script type="text/javascript" src="" charset="utf-8"></script>
    <script type="text/javascript" src="" charset="utf-8"></script>
    <title>Squid Users Guide</title>
  </head>
  <body bgcolor="#ffffff" link="#990000" vlink="#660000" alink="#660000">
    <!-- HEADLINE1 START-->
    <table width="100%" border="0">
      <tbody>
        <tr>
          <td bgcolor="9966ff">
            <font size="+3" color="FFFFFF">
              <b>More Configuration Details</b>
            </font>
          </td>
          <td bgcolor="BB99FF" width="5%">
            <font color="BB99FF">_</font>
          </td>
          <td bgcolor="DDCCFF" width="5%">
            <font color="DDCCFF">_</font>
          </td>
          <td bgcolor="F0E0FF" width="5%">
            <font color="F0E0FF">_</font>
          </td>
        </tr>
        <tr>
          <td bgcolor="9966ff" link="FFFFFF" valign="BASELINE">
            <font size="-1" color="#FFFFFF" acolor="#FFFFFF">
              <a href="/jwu.org/squid/Welcome.html">
                <img src="/jwu.org/squid/images/index.gif" align="BOTTOM" border="0">
                INDEX
              </a>
              <a href="client.html">
                <img src="/jwu.org/squid/images/back.gif" align="BOTTOM" border="0">
                BACK
              </a>
              <a href="/jwu.org/squid/hierarchies/concepts.html">
                <img src="/jwu.org/squid/images/next.gif" align="BOTTOM" border="0">
                NEXT
              </a>
            </font>
          </td>
          <td bgcolor="BB99FF" width="5%">
            <font color="BB99FF">_</font>
          </td>
          <td bgcolor="DDCCFF" width="5%">
            <font color="DDCCFF">_</font>
          </td>
          <td bgcolor="F0E0FF" width="5%">
            <font color="F0E0FF">_</font>
          </td>
        </tr>
      </tbody>
    </table>
    <!--HEADLINE1 END-->
    <p>
      <!--HEADLINE2 START-->
      <table width="100%" border="0">
        <tbody>
          <tr>
            <td bgcolor="CCCCFF">
              <font size="+1" face="arial,helvetica">
                <b>Cache accelerator mode</b>
              </font>
            </td>
            <td></td>
          </tr>
        </tbody>
      </table>
      <!--HEADLINE2 END-->
      <font face="arial,helvetica">Accelerator mode is a different operating style where instead of acting as a proxy, Squid acts as an origin web server. Instead ofserving up fixed (static) documents, though, it fetches documents from oneor more origin servers. It is called an accelerator since itcan serve up documents faster than classic httpd servers, which keepall pages on disk and tend to do more computation per request.</font>
    </p>
    <p>
      <font face="arial,helvetica">
        <font size="+1">
          <b>Why run an accelerator?</b>
        </font>
      </font>
    </p>
    <p>
      <font face="arial,helvetica">These are some reasons why you might want to run a web acceleratorusing Squid:</font>
    </p>
    <ul>
      <font face="arial,helvetica">
        <li>Server performance. Squid performs faster than the original web server, so you would like to make Squid the front end server, and put the original one behind it.</li>
        <li>
          Network performance. The origin server can be on a slow network, such as across international links. A web accelerator or mirror closer to the rest of the Net, physically located in the US for example, will make your web site faster for the rest of the world. 
          <p>Squid is easier to maintain than a regular httpd since you only have to add pages on the origin server and the mirror will catch up. You might want to put Expires headers in your HTTP responses to make sure that the mirror is not serving stale data.</p>
          <p>Anything that requires real intelligence on the part of the web server, such as CGI scripts, will be forwarded on to the origin server.</p>
        </li>
        <li>
          Security. You can use Squid to hide an internal server, or one is that is prone to attack, behind an accelerator. Web users visiting your site will never touch the internal server. If your web server is vulnerable to data-driven attacks, such as invalid URLs, Squid will either complain about them, or you can set up ACLs to block them off. 
          <p>One disadvantage is that the origin server will not know the original IP address of the clients, except through the X-Forwarded-For HTTP header. This will affect logging and visitor analysis, as well as document protection access control lists. You might want to move this log analysis to your accelerator instead.</p>
        </li>
      </font>
    </ul>
    <font face="arial,helvetica">
      <p>
        <font size="+1">
          <b>Configuring Squid as an Accelerator</b>
        </font>
      </p>
      <p>
        To make Squid run in accelerator mode, set the 
        <i>http_port</i>
         value to the port number you want it to listen to. This is usuallythe HTTP port, 80. Note that Squid must initially run as rootto be able to bind to port 80.
      </p>
      <p>The next step is to select the origin server you want to accelerate.You can make Squid choose one of three methods of operation:</p>
      <ul>
        <li>
          Accelerate only one origin server. Set 
          <i>httpd_accel origin-host origin-port</i>
           in the HTTPD-ACCELERATOR OPTIONS section. The origin-host can be any host, or even 
          <b>localhost</b>
           if the origin web server is on the same machine.
        </li>
        <li>
          Accelerate many origin servers using 
          <b>virtual host support</b>
           mode. This assumes that your server has multiple interfaces - Squid will bind to 
          <b>all</b>
           of them. Specify 
          <i>httpd_accel virtual</i>.
          This method requires an URL redirector to translate from the IP address the request was received on. Assume that your interfaces are
          <b>192.168.0.1</b>
           and 
          <b>192.168.0.2</b>.
          Squid will give the redirector
          <b>http://192.168.0.1/</b>
           or 
          <b>http://192.168.0.2/</b>,
          and the redirector should map these IP addresses to the corresponding hosts, say
          <b>www.domain1.com</b>
           and 
          <b>www.domain2.com</b>.
          This script is based on the one given in the Release Notes.
          <hr>
          <pre>#!/usr/bin/perl $|=1; while (&lt;&gt;) { s@http://192\.168\.0\.1@http://www.domain1.com@; s@http://192\.168\.0\.2@http://www.domain2.com@; print; }</pre>
          <hr>
        </li>
        <li>
          Accelerate many origin servers using the 
          <b>Host</b>
           header. This conserves IP addresses since only one in needed to handle an unlimited number of hosts. Instead, the client sends the desired hostname in the HTTP/1.1 
          <b>Host</b>
           header. However, this relies on the browser supporting that part of the protocol. Older browsers such as Netscape &lt; 2, MSIE &lt; 3, and Lynx &lt; 2.5 did not, and will fall back to the server given in 
          <i>httpd_accel</i>.
          To turn on this behavior, set
          <i>httpd_accel_uses_host_header on</i>.
          Squid will then use the
          <b>Host</b>
           header to determine what to use as the origin server. 
          <p>
            A redirector is required to translate the specified hostname into the origin server. Otherwise, Squid will try to accelerate itself, which is not very useful. Assuming the original hosts are called 
            <b>www</b>
             and the accelerator is called 
            <b>www2</b>,
            this script will do the translation:
          </p>
          <hr>
          <pre>#!/usr/bin/perl $|=1; while (&lt;&gt;) { s@http://www2.domain1.com@http://www.domain1.com@; s@http://www2.domain2.com@http://www.domain2.com@; print; }</pre>
          <hr>
          <p>
            The comments in 
            <b>squid.conf</b>
             note that this can be a security hole, since Squid does not check the 
            <b>Host</b>
             value, and be made to load any arbitrary web object, which is not desirable. To protect against this, create an ACL with the 
            <i>dstdomain</i>
             keyword that will limit the domains honored by the accelerator. For example:
          </p>
          <p></p>
          <hr>
          <pre>acl okdomains dstdomain domain1.com domain2.com http_access deny !okdomains http_access allow all</pre>
          <hr>
        </li>
      </ul>
      <!-- FILE ARCHIVED ON 19:27:58 Apr 25, 2001 AND RETRIEVED FROM THE INTERNET ARCHIVE ON 05:17:49 Jan 18, 2026. JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE. ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C. SECTION 108(a)(3)).-->
      <!--playback timings (ms): captures_list: 0.818 exclusion.robots: 0.053 exclusion.robots.policy: 0.036 esindex: 0.013 cdx.remote: 14.551 LoadShardBlock: 56.444 (3) PetaboxLoader3.datanode: 73.091 (4) load_resource: 81.011 PetaboxLoader3.resolve: 45.663 nav: 0.249 (6)-->
    </font>
  </body>
</html>